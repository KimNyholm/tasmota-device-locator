(function(e){function t(t){for(var s,i,o=t[0],u=t[1],c=t[2],l=0,h=[];l<o.length;l++)i=o[l],r[i]&&h.push(r[i][0]),r[i]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);d&&d(t);while(h.length)h.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(s=!1)}s&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},r={app:0},a=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("Tasmota Device Locator")]),n("p",[e._v("Locate your devices when you only know their subnet address")]),n("p",[e._v("If device does not show up, it may help to search again.")]),n("md-card",{attrs:{"md-with-hover":""}},[n("md-ripple",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Specify an IP address in the subnet")])]),n("md-card-content",[n("md-field",[n("md-input",{attrs:{placeholder:"ip"},model:{value:e.subnet,callback:function(t){e.subnet=t},expression:"subnet"}}),n("span",{staticClass:"md-helper-text"},[e._v("E.g. 192.168.0.123 will search from 192.168.0.0 upto 192.168.0.254")]),e.$v.subnet.ipAddress?e.$v.subnet.required?e._e():n("div",{staticClass:"error"},[e._v("IP is missing")]):n("div",{staticClass:"error"},[e._v("IP is not valid")])],1),n("md-field",[n("md-input",{attrs:{type:"password",placeholder:"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("span",{staticClass:"md-helper-text"},[e._v("Leave empty if no password is required")])],1)],1),n("md-card-actions",[e.$v.subnet.ipAddress&&e.$v.subnet.required?n("md-button",{staticClass:"md-raised",attrs:{disabled:e.searching},on:{click:function(t){return e.update(e.subnet)}}},[e._v("Search")]):e._e()],1)],1)],1),e.searching?n("md-progress-bar",{attrs:{"md-mode":"determinate","md-value":e.progress}}):e._e(),n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[e._v("Devices")])]),n("md-card-content",[n("DeviceList",{attrs:{devices:e.devices}}),n("DeviceSearch",{attrs:{search:e.searching,subnet:e.subnet,password:e.password},on:{deviceFound:e.deviceFound,searchStatus:e.searchStatus}})],1)],1),n("p",[e._v(" Note: Only Tasmota devices with CORS enabled will be found. CORS is enabled by default for Tasmota version before 7. For Tasmota version 7 CORS is default disabled.")]),n("p",[e._v("Any information collected is kept within the browser. No information is sent to the server.")]),e._m(0),n("p",[e._v("Copyrigth (C) Kim Nyholm 2019")])],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("More information and source on "),n("a",{attrs:{href:"https://github.com/KimNyholm/tasmota-device-locator"}},[e._v("github")])])}],i=n("b5ae"),o={name:"app",data:function(){return{count:0,devices:[],progress:0,subnet:"",password:"",searching:!1}},validations:{subnet:{required:i["required"],ipAddress:i["ipAddress"]}},methods:{deviceFound:function(e){this.devices.push(e)},update:function(){this.searching||(this.searching=!0,this.devices=[])},searchStatus:function(e){this.progress=e,100===e&&(this.searching=!1)}}},u=o,c=(n("e1c5"),n("2877")),d=Object(c["a"])(u,r,a,!1,null,"5dbfb7ce",null),l=d.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("md-table",{scopedSlots:e._u([{key:"md-table-row",fn:function(t){var s=t.item;return n("md-table-row",{},[n("md-table-cell",{attrs:{"md-label":"Device URL"}},[n("a",{attrs:{href:s.url,target:"_blank"}},[e._v(e._s(s.url))])]),n("md-table-cell",{attrs:{"md-label":"Access","md-sort-by":"state"}},[e._v(e._s(s.state))]),n("md-table-cell",{attrs:{"md-label":"Name","md-sort-by":"name"}},[e._v(e._s(s.name))]),n("md-table-cell",{attrs:{"md-label":"Model","md-sort-by":"Model"}},[e._v(e._s(s.model))]),n("md-table-cell",{attrs:{"md-label":"Version","md-sort-by":"Version"}},[e._v(e._s(s.version))])],1)}}]),model:{value:e.devices,callback:function(t){e.devices=t},expression:"devices"}},[n("md-table-empty-state",{attrs:{"md-label":"No devices found","md-description":"No devices found for this search. Try a different range or add devices to the network."}})],1)],1)},p=[],f={name:"DeviceList",props:["devices"],data:function(){return{}}},m=f,v=Object(c["a"])(m,h,p,!1,null,null,null),b=v.exports,w=function(){var e=this,t=e.$createElement;e._self._c;return e._e()},y=[],_=(n("7f7f"),n("386d"),n("5b1b").TasmotaDeviceClass),g={name:"DeviceSearch",props:["search","subnet","password"],data:function(){return{counter:0,total:0,queue:[]}},watch:{search:function(){this.search&&(this.$emit("searchStatus",0),this.populate(this.subnet))}},methods:{dequeue:function(){if(this.queue.length){var e=this.queue.shift();e.tryConnection()}},ipBase:function(e){var t=e.lastIndexOf("."),n=e.substring(0,t+1);return n},ipFirstNumber:function(e){var t=e.lastIndexOf("."),n=e.substring(t+1);return parseInt(n)},populate:function(e){var t=this.ipBase(e);this.counter=0,this.total=0;for(var n=0;n<255;n++){this.total++;var s=t+n,r=new _(s,this.password,this.tasmotaConnectionHandler);this.queue.push(r)}for(var a=256,i=0;i<a;i++)setTimeout(this.dequeue,2e3*i/a)},tasmotaConnectionHandler:function(e,t){if(this.dequeue(),this.counter++,t){var n=e.ip,s="http://"+n,r={IP:n,url:s,type:"Tasmota",state:e.state,name:e.name,model:e.model,version:e.version};this.$emit("deviceFound",r)}this.$emit("searchStatus",100*this.counter/this.total)}}},S=g,C=Object(c["a"])(S,w,y,!1,null,null,null),k=C.exports,O=n("43f9"),P=n.n(O),x=(n("51de"),n("e094"),n("1dce")),T=n.n(x);s["default"].config.productionTip=!1,s["default"].use(P.a),s["default"].use(T.a),s["default"].component("DeviceList",b),s["default"].component("DeviceSearch",k),new s["default"]({el:"#app",render:function(e){return e(l)}})},"5b1b":function(e,t,n){"use strict";n.r(t),n.d(t,"TasmotaDeviceClass",function(){return o});var s=n("d225"),r=n("b0b4"),a=n("8cef"),i=n("bc3a"),o=function(){function e(t,n,r){Object(s["a"])(this,e),this.connectionHandler=r,this.connected=!1,this.trying=!1,this.ip=t,this.password=n,this.name="unknown",this.model="unknown",this.version="unknown",this.state="unknown"}return Object(r["a"])(e,[{key:"buildCommand",value:function(e){var t="";return this.password&&(t="&user=admin&password="+this.password),"cm?cmnd="+e+t}},{key:"wait",value:function(e,t){return new Promise(function(n){setTimeout(function(){return n(t)},e)})}},{key:"tryConnection",value:function(){var e=this;this.trying||(this.trying=!0,this.API("Module").then(function(t){e.model=a(t,"data.Module");var n=a(t,"data.WARNING");return e.state="OK",n&&(e.state="Password protected"),e.API("FriendlyName")}).then(function(t){return e.wait(1,t)}).then(function(t){return e.name=a(t,"data.FriendlyName1"),e.API("Status%202")}).then(function(t){return e.wait(1,t)}).then(function(t){return e.version=a(t,"data.StatusFWR.Version"),e.setConnectionState(!0),Promise.resolve()}).catch(function(){e.setConnectionState(!1)}))}},{key:"setConnectionState",value:function(e){this.connectionHandler&&this.connectionHandler(this,e),this.connected=e}},{key:"API",value:function(e){var t=this.ip,n="http:////"+t+"/"+this.buildCommand(e);return i({url:n,method:"GET",timeout:2e3})}}]),e}()},"8b21":function(e,t,n){},e1c5:function(e,t,n){"use strict";var s=n("8b21"),r=n.n(s);r.a}});
//# sourceMappingURL=app.489b92b4.js.map